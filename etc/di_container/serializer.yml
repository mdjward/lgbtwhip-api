parameters:
    
    thelgbtwhip.api.serializer.builder.cache_dir:       %cache_dir%/serializer
    thelgbtwhip.api.serializer.namespace_mappings:
        TheLgbtWhip\Api\Model:                              %config_dir%/serializer
    
    thelgbtwhip.api.serializer.naming_strategy.class:   JMS\Serializer\Naming\CamelCaseNamingStrategy
    thelgbtwhip.api.serializer.real.class:              JMS\Serializer\Serializer
    thelgbtwhip.api.serializer.wrapper.class:           TheLgbtWhip\Api\Serializer\DepthRespectingSerializer
    
services:
    
    thelgbtwhip.api.serializer.naming_strategy:
        class: %thelgbtwhip.api.serializer.naming_strategy.class%
    
    thelgbtwhip.api.serializer.builder:
        class: JMS\Serializer\SerializerBuilder
        factory:
            - JMS\Serializer\SerializerBuilder
            - create
        calls:
            - [setDebug, [%mode.debug%]]
            - [setCacheDir, [%thelgbtwhip.api.serializer.builder.cache_dir%]]
            - [setMetadataDirs, [%thelgbtwhip.api.serializer.namespace_mappings%]]
            - [setPropertyNamingStrategy, [@thelgbtwhip.api.serializer.naming_strategy]]
    
    thelgbtwhip.api.serializer.real:
        class: %thelgbtwhip.api.serializer.real.class%
        factory:
            - @thelgbtwhip.api.serializer.builder
            - build

    thelgbtwhip.api.serializer.wrapper:
        class: %thelgbtwhip.api.serializer.wrapper.class%
        arguments:
            realSerializer: @thelgbtwhip.api.serializer.real

    thelgbtwhip.api.serializer:
        alias: thelgbtwhip.api.serializer.wrapper
